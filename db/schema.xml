<?xml version="1.0" encoding="UTF-8"?>

<database name="acrosstime" defaultIdMethod="native" tablePrefix="site_">
    <table name="user" phpName="User">
        <column name="user_id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
        <column name="ap" type="integer" required="true" defaultValue="0" />
        <column name="ep" type="integer" required="true" defaultValue="0" />
    </table>

    <table name="clock" phpName="Clock">
        <column name="clock_id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
        <column name="user_id" type="integer" required="true" />
        <column name="label" type="varchar" required="true" size="250" />
        <column name="time" type="integer" required="true" defaultValue="0" />
        <index>
            <index-column name="user_id" />
        </index>
        <index>
            <index-column name="label" />
        </index>
        <foreign-key foreignTable="user" phpName="User" refPhpName="Clock">
            <reference local="user_id" foreign="user_id" />
        </foreign-key>
    </table>
    
    <table name="clock_tag" phpName="ClockTag" heavyIndexing="true">
        <column name="clock_id" type="integer" required="true" primaryKey="true" />
        <column name="tag_id" type="integer" required="true" primaryKey="true" />
        <foreign-key foreignTable="clock" phpName="Clock" refPhpName="Tag">
            <reference local="user_id" foreign="user_id" />
        </foreign-key>
        <foreign-key foreignTable="tag" phpName="Tag" refPhpName="Clock">
            <reference local="tag_id" foreign="tag_id" />
        </foreign-key>
    </table>

    <table name="tag" phpName="Tag">
        <column name="tag_id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
        <column name="label" type="varchar" required="true" size="250" />
        <index>
            <index-column name="label" />
        </index>
    </table>

    <table name="clock_log" phpName="ClockLog">
        <column name="clock_id" type="integer" required="true" primaryKey="true" />
        <column name="start_time" type="timestamp" required="true" />
        <column name="time" type="integer" required="true" defaultValue="0" />
        <unique>
            <unique-column name="clock_id" />
            <unique-column name="start_time" />
        </unique>
        <foreign-key foreignTable="clock" phpName="Clock" refPhpName="Log">
            <reference local="clock_id" foreign="clock_id" />
        </foreign-key>
        <behavior name="timestampable">
            <parameter name="creatc_column" value="start_time" />
            <parameter name="disable_updated_at" value="true" />
        </behavior>
    </table>

    <table name="session" phpName="Session">
        <column name="session_id" type="varchar" required="true" primaryKey="true" />
        <column name="data" type="longvarchar" />
        <behavior name="timestampable" />
    </table>
</database>